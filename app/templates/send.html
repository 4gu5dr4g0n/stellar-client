
<div class="send-pane" ng-show="$root.tab==='send'" ng-controller="SendPaneCtrl">
<group ng-hide="connected" class="disconnected">
    <p l10n="l10n" class="literal">You have to be online to see this screen</p>
</group>
<div ng-hide="account.Balance || !connected" class="unfunded">
    <p l10n="l10n" class="literal">You have to be funded before you can send money</p>
    <p><a href="#/balance" l10n="l10n" class="btn btn-default">Back to balance</a></p>
</div>
<form name="sendForm" id="sendForm" role="form" ng-show="mode=='form' && account.Balance" ng-submit="send_prepared()" class="row-padding-small mode-form">
    <div class="close-send-tab" ng-click="closePane()">
        <span>Close</span>
        <i class="glyphicon glyphicon-remove-circle"></i>
    </div>
    <div l10n="l10n" class="literal title">Send Stellars</div>
    <div class="form-group">
        <label for="send_amount" l10n="l10n" class="col-sm-3">AMOUNT</label>
        <div ng-if="!send.currency_force" class="row amount">
            <div class="col-sm-6 send-amount right-inner-addon">
                <i>XTR</i>
                <input id="send_amount" name="send_amount" type="text" ng-model="send.amount" required="required" rp-autofill="$routeParams.amount" rp-autofill-amount="rp-autofill-amount" rp-amount="rp-amount" rp-amount-positive="rp-amount-positive" rp-amount-xtr-limit="rp-amount-xtr-limit" rp-amount-xtr-limit-currency="{{send.currency}}" class="form-control stellar-input"/>
            </div>
            <div class="col-sm-3 tip">Type in the address ot username.</div>
            <!--
                        <div class="col-xs-12 col-sm-6 col-md-3">
                            <input id="send_amount_currency" name="send_amount_currency" type="text" rp-combobox="{{send.currency_choices}}" rp-combobox-select="rp-combobox-select" ng-model="send.currency" rp-autofill="$routeParams.amount" rp-autofill-currency="rp-autofill-currency" rp-restrict-currencies="{{send.restrict_currencies}}" class="form-control currency"/>
                        </div>  -->
        </div>
        <!--
        <div ng-if="send.currency_force" class="row">
            <div class="col-xs-12 col-sm-6 col-md-3 input-group currency_force">
                <input id="send_amount" name="send_amount" type="text" ng-model="send.amount" required="required" ng-disabled="!!send.force_amount" rp-autofill="$routeParams.amount" rp-autofill-amount="rp-autofill-amount" rp-amount="rp-amount" rp-amount-positive="rp-amount-positive" rp-amount-xtr-limit="rp-amount-xtr-limit" rp-amount-xtr-limit-currency="{{send.currency}}" class="form-control"/><span ng-bind="send.currency_force" class="input-group-addon"></span>
            </div>
        </div>
        <div rp-errors="send_amount_currency" class="errorGroup">
            <div rp-error-on="rpRestrictCurrencies" l10n="l10n" class="error">{{send.recipient | rpcontactname}} can't receive this currency.</div>
        </div>  -->
        <div rp-errors="send_amount" class="errorGroup">
            <div rp-error-on="required" l10n="l10n" class="error">Please enter an amount.</div>
            <div rp-error-on="rpAmount" l10n="l10n" class="error">Not a valid amount.</div>
            <div rp-error-on="rpAmountPositive" l10n="l10n" class="error">Amount must be greater than zero.</div>
            <div rp-error-on="rpMaxAmount" l10n="l10n" class="error">
                This transaction exceeds your balance, you can send
                a max. of {{account.max_spend | rpamount:{rel_precision: 0} }} XTR
            </div>
            <div ng-show="send.recipient_info.disallow_xtr && send.currency_code=='XTR'" l10n="l10n" class="error">Recipient does not allow XTR payments. Are you sure you want to send XTR anyway?</div>
            <div ng-show="send.trust_limit" l10n="l10n" class="notice">
                {{send.recipient | rpcontactname}}
                trusts you for {{send.trust_limit | rpamount}} {{send.trust_limit | rpcurrency}}.
            </div>
        </div>
    </div>
    <div class="row form-group">
        <label for="send_destination" l10n="l10n" class="col-sm-3">ADDRESS</label>
        <div class="col-sm-6 send-address right-inner-addon">
            <i class="glyphicon glyphicon-globe"></i>
            <input id="send_destination" name="send_destination" type="text" rp-combobox="recipient_query" ng-model="send.recipient" rp-dest="rp-dest" rp-dest-address="rp-dest-address" rp-dest-contact="rp-dest-contact" rp-dest-bitcoin="rp-dest-bitcoin" rp-dest-email="rp-dest-email" required="required" rp-autofill="$routeParams.to" rp-focus="rp-focus" class="form-control stellar-input"/>
        </div>
        <div class="col-sm-3 tip">Type in the address ot username.</div>
        <div rp-errors="send_destination" class="errorGroup">
            <div rp-error-valid ng-show="send.recipient != send.recipient_address" class="success">{{send.recipient_address}}</div>
            <div rp-error-on="required" l10n="l10n" class="error">Please enter a recipient.</div>
            <div rp-error-on="rpDest" l10n="l10n" class="error">Recipient should be either a name from your contact list or Ripple/Bitcoin address.</div>
            <div rp-error-on="federation" l10n="l10n" class="error">This email address is not Ripple-enabled.</div>
        </div>
    </div>
    <div ng-show="send.show_dt_field" class="row form-group">
        <label for="send_dt" l10n="l10n" class="col-sm-3">Destination tag</label>
        <div class="col-sm-6">
            <input id="send_dt" name="send_dt" type="text" ng-model="send.dt" rp-stdt="rp-stdt" rp-autofill="$routeParams.dt" ng-required="send.recipient_info.dest_tag_required" class="form-control"/>
        </div>
        <div rp-errors="send_dt" class="errorGroup">
            <div rp-error-on="rpStdt" l10n="l10n" class="error">Invalid destination tag</div>
            <div rp-error-on="required" l10n="l10n" class="error">Destination cannot be blank.</div>
        </div>
        <div ng-show="send.recipient_info.dest_tag_required" l10n="l10n">
            Recipient requires a destination tag to be specified for the transaction. If you don't know the
            destination tag, please contact them before doing a transaction.
        </div>
    </div>
    <div ng-show="$routeParams.st || send.st" class="row form-group">
        <label for="send_st" l10n="l10n" class="col-sm-3">Source tag</label>
        <div class="col-sm-6">
            <input id="send_st" name="send_st" type="text" ng-model="send.st" rp-stdt="rp-stdt" rp-autofill="$routeParams.st" class="form-control"/>
        </div>
        <div rp-errors="send_st" class="errorGroup">
            <div rp-error-on="rpStdt" l10n="l10n" class="error">Invalid source tag</div>
        </div>
    </div>
    <div ng-repeat="field in send.extra_fields" ng-switch="field.type" class="row form-group">
        <div ng-switch-when="text">
            <label ng-bind="field.label" class="col-sm-3"></label>
            <p ng-show="field.hint" ng-bind="field.hint" class="field-hint"></p>
            <div class="col-sm-6">
                <input type="text" ng-model="field.value" ng-required="{{field.required}}" class="form-control"/>
            </div>
        </div>
        <div ng-switch-when="select">
            <label ng-bind="field.label" class="col-sm-3"></label>
            <p ng-show="field.hint" ng-bind="field.hint" class="field-hint"></p>
            <div class="col-sm-6">
                <select type="text" ng-model="field.value" ng-required="{{field.required}}" class="form-control">
                    <option ng-repeat="option in field.options" ng-bind="option.label" value="{{option.value}}" ng-selected="option.selected" ng-disabled="option.disabled"></option>
                </select>
            </div>
        </div>
    </div>
    <!--
    <ul class="tagsLinks">
        <li><a href="" ng-click="send.show_dt_field = true" ng-hide="send.show_dt_field || send.bitcoin || send.federation" l10n="l10n">Add Destination tag</a></li>
    </ul>  -->
    <div class="row">
        <div ng-show="send.currency_code == 'XTR'">
            <button type="submit" ng-disabled="sendForm.$invalid || send.self || !send.recipient_resolved || account.max_spend.to_number() < send.amount * 1000000" l10n="l10n" class="btn btn-default submit col-sm-offset-3 col-sm-6 stellar-button">Send</button>
        </div>
    </div>
    <div class="remote">
        <p ng-show="send.fund_status == 'insufficient-xtr'" l10n="l10n" class="literal">
            Destination account is unfunded; send at least
            {{send.xtr_deficiency | rpamount}} XTR to fund it.<a href="https://ripple.com/wiki/Reserves" target="_blank" l10n="l10n">More information</a>
        </p>
        <p ng-show="send.path_status == 'checking'" rp-spinner="4" l10n="l10n" class="literal">Checking</p>
        <p ng-show="send.path_status == 'fed-check'" rp-spinner="4" l10n="l10n" class="literal">Analyzing address</p>
        <p ng-show="send.path_status == 'bridge-quote'" rp-spinner="4" l10n="l10n" class="literal">Requesting quote</p>
        <p ng-show="send.path_status == 'pending' && send.currency_code != 'XTR'" rp-spinner="4" l10n="l10n" class="literal">Calculating paths</p>
        <p ng-show="send.path_status == 'pending' && send.currency_code == 'XTR'" rp-spinner="4" l10n="l10n" class="literal">Calculating alternatives</p>
        <p ng-show="send.path_status == 'no-path' && send.currency_code != 'XTR'" l10n="l10n" class="literal">
            Sorry! Cannot send {{send.amount}} {{send.currency}} to
            {{send.recipient}}. Please make sure your account has enough funds,
            and the recipient has enough trust to the currency issuer. If it still
            doesn't work, try again later.
        </p>
        <p ng-show="send.path_status == 'error-quote'" l10n="l10n" class="literal">Error while retrieving quote for outbound payment.<span ng-show="send.quote_error"> The outbound bridge reported: "{{send.quote_error | rpheavynormalize}}"</span></p>
        <p ng-show="send.path_status == 'error'" l10n="l10n" class="literal">Error while calculating path</p>
        <div ng-if="send.path_status == 'done'" class="currency_sets">
            <div class="row row-padding-small">
                <div class="col-xs-12">
                    <p ng-show="send.currency_code != 'XTR' || send.bitcoin" l10n="l10n" class="literal">You can send</p>
                    <p ng-show="send.currency_code == 'XTR' && !send.bitcoin" l10n="l10n" class="literal">Or you can send</p>
                </div>
            </div>
            <div ng-show="send.alternatives.length" class="row row-padding-small alternatives">
                <div ng-repeat="alt in send.alternatives" class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
                    <div class="margin">
                        <div class="am"><span class="amnt">{{alt.amount | rpamount:{rel_precision: 4, rel_min_precision: 2} }}</span><span class="currency">{{alt.amount | rpcurrency }}</span>
                            <div class="ex">(<span class="rate">{{alt.rate | rpamount:{rel_precision: 4, rel_min_precision: 2} }}</span><span class="pair">{{send.currency_code}}/{{alt.amount | rpcurrency}}</span>)</div>
                        </div>
                        <button type="submit" ng-disabled="sendForm.$invalid" ng-click="send.alt = alt" l10n="l10n" class="btn btn-block btn-success">Send {{ alt.amount | rpcurrency }}</button>
                    </div>
                </div>
            </div>
            <div ng-show="send.alternatives.length && lastUpdate" class="row row-padding-small pathupdate">
                <div l10n="l10n" class="col-xs-12">Paths last updated<span> {{lastUpdate}}</span><span ng-show="lastUpdate &gt; '1'" l10n-inc="l10n-inc"> seconds</span><span ng-show="lastUpdate == '1'" l10n-inc="l10n-inc"> second</span> ago</div>
            </div>
        </div>
    </div>
</form>
<group ng-show="mode=='wait_path' && account.Balance" class="mode-wait-path">
    <p rp-spinner="4" l10n="l10n" class="literal">Ripple is calculating a path for your payment.</p>
</group>
<group ng-show="mode=='confirm' && account.Balance" class="mode-confirm">
    <p l10n="l10n" class="literal">You are sending {{ (send.alt.amount || send.currency) | rpcurrency}} to</p>
    <div class="dest_feedback">
        <div ng-show="send.recipient_name" class="recipient">{{send.recipient_name}}</div>
        <div ng-hide="send.recipient_name" class="recipient">{{send.recipient_address}}</div>
        <div href="" ng-show="send.recipient != send.recipient_address || send.recipient_name" class="extra"> {{send.recipient_address}}</div>
        <div ng-show="send.dt" l10n="l10n" class="dt">Destination tag: {{send.dt}}</div>
    </div>
    <p l10n="l10n" class="literal">They will receive</p>
    <p class="amount_feedback"><span class="value">{{send.amount_feedback | rpamount}}&#32;</span><span class="currency">{{send.amount_feedback | rpcurrency}}</span></p>
    <group ng-show="send.indirect">
        <p l10n="l10n" class="literal">You will pay at most</p>
        <p class="sendmax_feedback"><span class="value">{{send.alt.amount | rpamount}}&#32;</span><span class="currency">{{send.alt.amount | rpcurrency}} &#32;</span><span>&plusmn; 1%</span></p>
    </group>
    <div class="call-to-action">
        <p l10n="l10n" class="literal">Are you sure?</p>
        <div class="row row-padding-small">
            <div class="col-xs-6 col-sm-4 col-md-3 col-lg-2">
                <button ng-click="cancelConfirm()" l10n="l10n" class="btn btn-block btn-default back">&laquo; Back</button>
            </div>
            <div class="col-xs-6 col-sm-4 col-md-3 col-lg-2">
                <button type="submit" ng-click="send_confirmed()" ng-disabled="confirm_wait" l10n="l10n" class="btn btn-block btn-success submit">Confirm</button>
            </div>
        </div>
    </div>
</group>
<group ng-show="mode=='sending' && account.Balance" class="mode-sending">
    <p rp-spinner="4" l10n="l10n" class="literal">Sending transaction to Ripple network</p>
    <hr/>
    <p>
        <button ng-click="reset()" l10n="l10n" class="btn btn-default">Stop waiting</button>
    </p>
</group>
<group ng-show="mode=='error' && account.Balance" class="mode-error">
    <group ng-switch on="error_type">
        <group ng-switch-when="noDest" class="result-error">
            <h2 l10n="l10n" class="tx-status">Destination does not exist</h2>
            <p l10n="l10n">The wallet you&#39;re trying to send to does not exist.</p>
        </group>
        <group ng-switch-when="noPath" class="result-error">
            <h2 l10n="l10n" class="tx-status">No Path</h2>
            <p l10n="l10n">Ripple was unable to find a path between you and the destination account.</p>
        </group>
        <group ng-switch-when="invalidTransaction" class="result-error">
            <h2 l10n="l10n" class="tx-status">Invalid transaction</h2>
            <p l10n="l10n">The transaction was rejected by the server due to a client issue.</p>
        </group>
        <group ng-switch-default="ng-switch-default">
            <p l10n="l10n" class="literal">
                Sorry, an error occurred while submitting your transaction.
                Make sure you are connected to the Internet and try again later.
            </p>
            <p l10n="l10n" class="literal">Please ensure you don't send your payment more than once.</p>
        </group>
    </group>
    <p>
        <button ng-click="cancelConfirm()" l10n="l10n" class="btn btn-default">&laquo; Back</button>
    </p>
</group>
<group ng-show="mode=='rippleerror' && account.Balance" class="mode-ripplerror">
    <rp-transaction-status rp-engine-result="{{engine_result}}" rp-engine-result-message="{{engine_result_message}}" rp-accepted="{{engine_status_accepted}}"></rp-transaction-status>
    <group class="actions">
        <hr/>
        <div ng-show="addressSaved" l10n="l10n" class="text-success actionLink">Contact saved!</div>
        <div ng-hide="contact" class="save-address-form actionLink"><a href="" ng-click="show_save_address_form = true" l10n="l10n">Add this address to contacts</a>
            <form name="saveAddressForm" ng-class="{ show: show_save_address_form }" ng-submit="saveAddress()">
                <div class="address">{{send.recipient_address}}</div>
                <label for="save_address_name" l10n="l10n">Name this user</label>
                <input id="contact_name" name="save_address_name" type="text" ng-model="saveAddressName" unique="unique" required="required" rp-autofill="$routeParams.name" class="form-control"/>
                <div ng-show="saveAddressForm.save_address_name.$error.unique" l10n="l10n" class="error">You already have a contact with the same name.</div>
                <div>
                    <button type="submit" ng-disabled="addressSaving" class="btn btn-success"><span ng-show="addressSaving" l10n="l10n">Saving...</span><span ng-hide="addressSaving" l10n="l10n">Save</span></button><a href="" ng-click="show_save_address_form = false" l10n="l10n">Cancel</a>
                </div>
                <hr/>
            </form>
        </div>
        <div class="actionLink"><a href="" ng-click="reset()" l10n="l10n">Send another payment</a></div>
        <div class="actionLink"><a href="" ng-click="reset_goto('balance')" l10n="l10n">Back to balance</a></div>
        <hr/>
    </group>
</group>
<group ng-show="mode=='status' && account.Balance" class="mode-status">
    <group ng-show="tx_result=='pending'" class="pending">
        <h2 l10n="l10n" class="tx-status">Your transaction has been submitted.</h2>
        <p l10n="l10n">Your account balance will update once the payment has cleared.</p>
    </group>
    <group ng-show="tx_result=='cleared'" class="result-success">
        <h2 l10n="l10n" class="tx-status">Transaction cleared!</h2>
    </group>
    <group ng-show="tx_result=='partial'" class="result-partial">
        <h2 l10n="l10n" class="tx-status">Transaction partially valid!</h2>
        <p l10n="l10n">Your transaction could only be partially applied.</p>
    </group>
    <group ng-show="tx_result=='error'" class="result-error">
        <h2 l10n="l10n" class="tx-status">Transaction could not be submitted!</h2>
        <p l10n="l10n">
            We were unable to submit the transaction to the server.
            Please try again later.
        </p>
    </group>
    <group ng-show="tx_result=='malformed'" class="result-malformed">
        <h2 l10n="l10n" class="tx-status">Transaction malformed!</h2>
        <p ng-switch on="engine_result"><span ng-switch-default="ng-switch-default" l10n="l10n">Your transaction is invalid, reason: {{engine_result}} - {{engine_result_message}}</span></p>
    </group>
    <group ng-show="tx_result=='failure'" class="result-malformed">
        <h2 l10n="l10n" class="tx-status">Transaction malformed!</h2>
        <p ng-switch on="engine_result"><span ng-switch-when="tefDST_TAG_NEEDED" l10n="l10n">Destination account requires destination tag to be specified when making payments.</span></p>
    </group>
    <group ng-show="tx_result=='local'" class="result-failed">
        <h2 l10n="l10n" class="tx-status">Transaction failed!</h2>
        <p ng-switch on="engine_result"><span ng-switch-when="telINSUF_FEE_P" l10n="l10n">
          The particular server you sent the transaction to was too busy to forward or process
           your transaction at the fee you included in it.</span></p>
    </group>
    <group ng-show="tx_result=='claim'" class="result-malformed">
        <h2 l10n="l10n" class="tx-status">Transaction failed!</h2>
        <p ng-switch on="engine_result"><span ng-switch-when="tecNO_DST" l10n="l10n">The destination account does not exist.</span><span ng-switch-when="tecNO_DST_INSUF_XRP" l10n="l10n">The destination account does not exist. Too little XTR sent to create it.</span><span ng-switch-default="ng-switch-default" l10n="l10n">Error: {{engine_result_message}}</span></p>
    </group>
    <group ng-show="tx_result=='failed'" class="result-failed">
        <h2 l10n="l10n" class="tx-status">Transaction failed!</h2>
        <p ng-switch on="engine_result"><span ng-switch-when="terNO_LINE" l10n="l10n">You have no trust line in this currency.</span><span ng-switch-default="ng-switch-default" l10n="l10n">Your transaction failed to clear, reason: {{engine_result_message}}</span></p>
    </group>
    <group class="actions">
        <hr/>
        <!-- <div ng-show="addressSaved" l10n="l10n" class="text-success actionLink">Contact saved!</div>
        <div ng-hide="contact" class="save-address-form actionLink"><a href="" ng-click="show_save_address_form = true" l10n="l10n">Add this address to contacts</a>
            <form name="saveAddressForm" ng-class="{ show: show_save_address_form }" ng-submit="saveAddress()">
                <div class="address">{{send.recipient_address}}</div>
                <label for="save_address_name" l10n="l10n">Name this user</label>
                <input id="contact_name" name="save_address_name" type="text" ng-model="saveAddressName" unique="unique" required="required" rp-autofill="$routeParams.name" class="form-control"/>
                <div ng-show="saveAddressForm.save_address_name.$error.unique" l10n="l10n" class="error">You already have a contact with the same name.</div>
                <div>
                    <button type="submit" ng-disabled="addressSaving" class="btn btn-success"><span ng-show="addressSaving" l10n="l10n">Saving...</span><span ng-hide="addressSaving" l10n="l10n">Save</span></button><a href="" ng-click="show_save_address_form = false" l10n="l10n">Cancel</a>
                </div>
                <hr/>
            </form>
        </div> -->
        <div class="actionLink"><a href="" ng-click="reset()" l10n="l10n">Send another payment</a></div>
        <!-- <div class="actionLink"><a href="" ng-click="reset_goto('balance')" l10n="l10n">Back to balance</a></div> -->
        <hr/>
    </group>
</group>
</div>





